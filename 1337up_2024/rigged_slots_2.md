# Rigged Slots 2
The program starts out by asking for the user's name.  Using Ghidra to decompile the code, I can see that it uses `gets()` to get input from `stdin` into a stack buffer of 20 chars. Now I know I'm likely looking at a buffer overflow, from the main function, which doesn't return.  I start by looking at the variables on the stack.  The first one above the input buffer is the budget variable.  This means that I can change the budget to whatever I want to at the start of the program.  Further examining the code reveals that we are trying to get a budget of $1,337,420.  The budget is only checked after each round of gambling, so I set the budget to $1,337,421 and assume that I will lose $1 in the first round.  In hex, the target value is `0x0014684D`.  I prepend on 20 arbitrary characters to fill the buffer and reverse the order, sending the character values `01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 4D 68 14 00` to the program as my name.  Then, I gamble $1 in the first round and, if I lose, my balance reaches $1,337,420 and the flag is revealed.
